{"ast":null,"code":"import e, { useMemo as t, useCallback as r, useState as n, useEffect as o, forwardRef as i, useImperativeHandle as a } from \"react\";\nimport { useGetIdentity as c, fetchUtils as l, useRecordContext as u, useNotify as s, TextField as d, DateField as f, RichTextField as p, useGetOne as m, LinearProgress as h, useQuery as v } from \"react-admin\";\nimport { RichTextInput as y, DefaultEditorOptions as b } from \"ra-richtext-tiptap\";\nimport g from \"@tiptap/extension-placeholder\";\nimport { Form as w } from \"react-final-form\";\nimport { makeStyles as E, Box as x, Avatar as O, Button as T, Typography as I, CircularProgress as L } from \"@material-ui/core\";\nimport A from \"@material-ui/icons/Send\";\nimport { buildBlankNodesQuery as k, useDataModel as j } from \"@semapps/semantic-data-provider\";\nimport { AuthDialog as N } from \"@semapps/auth-provider\";\nimport { mergeAttributes as C } from \"@tiptap/core\";\nimport R from \"@tiptap/extension-mention\";\nimport { ReferenceField as S, AvatarWithLabelField as P, ReferenceArrayField as D } from \"@semapps/field-components\";\nimport { ReactRenderer as F } from \"@tiptap/react\";\nimport M from \"tippy.js\";\nfunction H(e, t) {\n  var r = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var n = Object.getOwnPropertySymbols(e);\n    t && (n = n.filter(function (t) {\n      return Object.getOwnPropertyDescriptor(e, t).enumerable;\n    })), r.push.apply(r, n);\n  }\n  return r;\n}\nfunction U(e) {\n  for (var t = 1; t < arguments.length; t++) {\n    var r = null != arguments[t] ? arguments[t] : {};\n    t % 2 ? H(Object(r), !0).forEach(function (t) {\n      V(e, t, r[t]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : H(Object(r)).forEach(function (t) {\n      Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t));\n    });\n  }\n  return e;\n}\nfunction B() {\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  B = function B() {\n    return e;\n  };\n  var e = {},\n    t = Object.prototype,\n    r = t.hasOwnProperty,\n    n = \"function\" == typeof Symbol ? Symbol : {},\n    o = n.iterator || \"@@iterator\",\n    i = n.asyncIterator || \"@@asyncIterator\",\n    a = n.toStringTag || \"@@toStringTag\";\n  function c(e, t, r) {\n    return Object.defineProperty(e, t, {\n      value: r,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), e[t];\n  }\n  try {\n    c({}, \"\");\n  } catch (e) {\n    c = function c(e, t, r) {\n      return e[t] = r;\n    };\n  }\n  function l(e, t, r, n) {\n    var o = t && t.prototype instanceof d ? t : d,\n      i = Object.create(o.prototype),\n      a = new O(n || []);\n    return i._invoke = function (e, t, r) {\n      var n = \"suspendedStart\";\n      return function (o, i) {\n        if (\"executing\" === n) throw new Error(\"Generator is already running\");\n        if (\"completed\" === n) {\n          if (\"throw\" === o) throw i;\n          return I();\n        }\n        for (r.method = o, r.arg = i;;) {\n          var a = r.delegate;\n          if (a) {\n            var c = w(a, r);\n            if (c) {\n              if (c === s) continue;\n              return c;\n            }\n          }\n          if (\"next\" === r.method) r.sent = r._sent = r.arg;else if (\"throw\" === r.method) {\n            if (\"suspendedStart\" === n) throw n = \"completed\", r.arg;\n            r.dispatchException(r.arg);\n          } else \"return\" === r.method && r.abrupt(\"return\", r.arg);\n          n = \"executing\";\n          var l = u(e, t, r);\n          if (\"normal\" === l.type) {\n            if (n = r.done ? \"completed\" : \"suspendedYield\", l.arg === s) continue;\n            return {\n              value: l.arg,\n              done: r.done\n            };\n          }\n          \"throw\" === l.type && (n = \"completed\", r.method = \"throw\", r.arg = l.arg);\n        }\n      };\n    }(e, r, a), i;\n  }\n  function u(e, t, r) {\n    try {\n      return {\n        type: \"normal\",\n        arg: e.call(t, r)\n      };\n    } catch (e) {\n      return {\n        type: \"throw\",\n        arg: e\n      };\n    }\n  }\n  e.wrap = l;\n  var s = {};\n  function d() {}\n  function f() {}\n  function p() {}\n  var m = {};\n  c(m, o, function () {\n    return this;\n  });\n  var h = Object.getPrototypeOf,\n    v = h && h(h(T([])));\n  v && v !== t && r.call(v, o) && (m = v);\n  var y = p.prototype = d.prototype = Object.create(m);\n  function b(e) {\n    [\"next\", \"throw\", \"return\"].forEach(function (t) {\n      c(e, t, function (e) {\n        return this._invoke(t, e);\n      });\n    });\n  }\n  function g(e, t) {\n    var n;\n    this._invoke = function (o, i) {\n      function a() {\n        return new t(function (n, a) {\n          !function n(o, i, a, c) {\n            var l = u(e[o], e, i);\n            if (\"throw\" !== l.type) {\n              var s = l.arg,\n                d = s.value;\n              return d && \"object\" == typeof d && r.call(d, \"__await\") ? t.resolve(d.__await).then(function (e) {\n                n(\"next\", e, a, c);\n              }, function (e) {\n                n(\"throw\", e, a, c);\n              }) : t.resolve(d).then(function (e) {\n                s.value = e, a(s);\n              }, function (e) {\n                return n(\"throw\", e, a, c);\n              });\n            }\n            c(l.arg);\n          }(o, i, n, a);\n        });\n      }\n      return n = n ? n.then(a, a) : a();\n    };\n  }\n  function w(e, t) {\n    var r = e.iterator[t.method];\n    if (void 0 === r) {\n      if (t.delegate = null, \"throw\" === t.method) {\n        if (e.iterator.return && (t.method = \"return\", t.arg = void 0, w(e, t), \"throw\" === t.method)) return s;\n        t.method = \"throw\", t.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n      return s;\n    }\n    var n = u(r, e.iterator, t.arg);\n    if (\"throw\" === n.type) return t.method = \"throw\", t.arg = n.arg, t.delegate = null, s;\n    var o = n.arg;\n    return o ? o.done ? (t[e.resultName] = o.value, t.next = e.nextLoc, \"return\" !== t.method && (t.method = \"next\", t.arg = void 0), t.delegate = null, s) : o : (t.method = \"throw\", t.arg = new TypeError(\"iterator result is not an object\"), t.delegate = null, s);\n  }\n  function E(e) {\n    var t = {\n      tryLoc: e[0]\n    };\n    1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t);\n  }\n  function x(e) {\n    var t = e.completion || {};\n    t.type = \"normal\", delete t.arg, e.completion = t;\n  }\n  function O(e) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], e.forEach(E, this), this.reset(!0);\n  }\n  function T(e) {\n    if (e) {\n      var t = e[o];\n      if (t) return t.call(e);\n      if (\"function\" == typeof e.next) return e;\n      if (!isNaN(e.length)) {\n        var n = -1,\n          i = function t() {\n            for (; ++n < e.length;) if (r.call(e, n)) return t.value = e[n], t.done = !1, t;\n            return t.value = void 0, t.done = !0, t;\n          };\n        return i.next = i;\n      }\n    }\n    return {\n      next: I\n    };\n  }\n  function I() {\n    return {\n      value: void 0,\n      done: !0\n    };\n  }\n  return f.prototype = p, c(y, \"constructor\", p), c(p, \"constructor\", f), f.displayName = c(p, a, \"GeneratorFunction\"), e.isGeneratorFunction = function (e) {\n    var t = \"function\" == typeof e && e.constructor;\n    return !!t && (t === f || \"GeneratorFunction\" === (t.displayName || t.name));\n  }, e.mark = function (e) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(e, p) : (e.__proto__ = p, c(e, a, \"GeneratorFunction\")), e.prototype = Object.create(y), e;\n  }, e.awrap = function (e) {\n    return {\n      __await: e\n    };\n  }, b(g.prototype), c(g.prototype, i, function () {\n    return this;\n  }), e.AsyncIterator = g, e.async = function (t, r, n, o, i) {\n    void 0 === i && (i = Promise);\n    var a = new g(l(t, r, n, o), i);\n    return e.isGeneratorFunction(r) ? a : a.next().then(function (e) {\n      return e.done ? e.value : a.next();\n    });\n  }, b(y), c(y, a, \"Generator\"), c(y, o, function () {\n    return this;\n  }), c(y, \"toString\", function () {\n    return \"[object Generator]\";\n  }), e.keys = function (e) {\n    var t = [];\n    for (var r in e) t.push(r);\n    return t.reverse(), function r() {\n      for (; t.length;) {\n        var n = t.pop();\n        if (n in e) return r.value = n, r.done = !1, r;\n      }\n      return r.done = !0, r;\n    };\n  }, e.values = T, O.prototype = {\n    constructor: O,\n    reset: function reset(e) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = void 0, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = void 0, this.tryEntries.forEach(x), !e) for (var t in this) \"t\" === t.charAt(0) && r.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = void 0);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var e = this.tryEntries[0].completion;\n      if (\"throw\" === e.type) throw e.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(e) {\n      if (this.done) throw e;\n      var t = this;\n      function n(r, n) {\n        return a.type = \"throw\", a.arg = e, t.next = r, n && (t.method = \"next\", t.arg = void 0), !!n;\n      }\n      for (var o = this.tryEntries.length - 1; o >= 0; --o) {\n        var i = this.tryEntries[o],\n          a = i.completion;\n        if (\"root\" === i.tryLoc) return n(\"end\");\n        if (i.tryLoc <= this.prev) {\n          var c = r.call(i, \"catchLoc\"),\n            l = r.call(i, \"finallyLoc\");\n          if (c && l) {\n            if (this.prev < i.catchLoc) return n(i.catchLoc, !0);\n            if (this.prev < i.finallyLoc) return n(i.finallyLoc);\n          } else if (c) {\n            if (this.prev < i.catchLoc) return n(i.catchLoc, !0);\n          } else {\n            if (!l) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < i.finallyLoc) return n(i.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(e, t) {\n      for (var n = this.tryEntries.length - 1; n >= 0; --n) {\n        var o = this.tryEntries[n];\n        if (o.tryLoc <= this.prev && r.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) {\n          var i = o;\n          break;\n        }\n      }\n      i && (\"break\" === e || \"continue\" === e) && i.tryLoc <= t && t <= i.finallyLoc && (i = null);\n      var a = i ? i.completion : {};\n      return a.type = e, a.arg = t, i ? (this.method = \"next\", this.next = i.finallyLoc, s) : this.complete(a);\n    },\n    complete: function complete(e, t) {\n      if (\"throw\" === e.type) throw e.arg;\n      return \"break\" === e.type || \"continue\" === e.type ? this.next = e.arg : \"return\" === e.type ? (this.rval = this.arg = e.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === e.type && t && (this.next = t), s;\n    },\n    finish: function finish(e) {\n      for (var t = this.tryEntries.length - 1; t >= 0; --t) {\n        var r = this.tryEntries[t];\n        if (r.finallyLoc === e) return this.complete(r.completion, r.afterLoc), x(r), s;\n      }\n    },\n    catch: function _catch(e) {\n      for (var t = this.tryEntries.length - 1; t >= 0; --t) {\n        var r = this.tryEntries[t];\n        if (r.tryLoc === e) {\n          var n = r.completion;\n          if (\"throw\" === n.type) {\n            var o = n.arg;\n            x(r);\n          }\n          return o;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(e, t, r) {\n      return this.delegate = {\n        iterator: T(e),\n        resultName: t,\n        nextLoc: r\n      }, \"next\" === this.method && (this.arg = void 0), s;\n    }\n  }, e;\n}\nfunction _(e, t, r, n, o, i, a) {\n  try {\n    var c = e[i](a),\n      l = c.value;\n  } catch (e) {\n    return void r(e);\n  }\n  c.done ? t(l) : Promise.resolve(l).then(n, o);\n}\nfunction G(e) {\n  return function () {\n    var t = this,\n      r = arguments;\n    return new Promise(function (n, o) {\n      var i = e.apply(t, r);\n      function a(e) {\n        _(i, n, o, a, c, \"next\", e);\n      }\n      function c(e) {\n        _(i, n, o, a, c, \"throw\", e);\n      }\n      a(void 0);\n    });\n  };\n}\nfunction V(e, t, r) {\n  return t in e ? Object.defineProperty(e, t, {\n    value: r,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[t] = r, e;\n}\nfunction z() {\n  return (z = Object.assign ? Object.assign.bind() : function (e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var r = arguments[t];\n      for (var n in r) Object.prototype.hasOwnProperty.call(r, n) && (e[n] = r[n]);\n    }\n    return e;\n  }).apply(this, arguments);\n}\nfunction J(e, t) {\n  if (null == e) return {};\n  var r,\n    n,\n    o = function (e, t) {\n      if (null == e) return {};\n      var r,\n        n,\n        o = {},\n        i = Object.keys(e);\n      for (n = 0; n < i.length; n++) r = i[n], t.indexOf(r) >= 0 || (o[r] = e[r]);\n      return o;\n    }(e, t);\n  if (Object.getOwnPropertySymbols) {\n    var i = Object.getOwnPropertySymbols(e);\n    for (n = 0; n < i.length; n++) r = i[n], t.indexOf(r) >= 0 || Object.prototype.propertyIsEnumerable.call(e, r) && (o[r] = e[r]);\n  }\n  return o;\n}\nfunction W(e, t) {\n  return function (e) {\n    if (Array.isArray(e)) return e;\n  }(e) || function (e, t) {\n    var r = null == e ? null : \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n    if (null == r) return;\n    var n,\n      o,\n      i = [],\n      a = !0,\n      c = !1;\n    try {\n      for (r = r.call(e); !(a = (n = r.next()).done) && (i.push(n.value), !t || i.length !== t); a = !0);\n    } catch (e) {\n      c = !0, o = e;\n    } finally {\n      try {\n        a || null == r.return || r.return();\n      } finally {\n        if (c) throw o;\n      }\n    }\n    return i;\n  }(e, t) || q(e, t) || function () {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }();\n}\nfunction K(e) {\n  return function (e) {\n    if (Array.isArray(e)) return Q(e);\n  }(e) || function (e) {\n    if (\"undefined\" != typeof Symbol && null != e[Symbol.iterator] || null != e[\"@@iterator\"]) return Array.from(e);\n  }(e) || q(e) || function () {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }();\n}\nfunction q(e, t) {\n  if (e) {\n    if (\"string\" == typeof e) return Q(e, t);\n    var r = Object.prototype.toString.call(e).slice(8, -1);\n    return \"Object\" === r && e.constructor && (r = e.constructor.name), \"Map\" === r || \"Set\" === r ? Array.from(e) : \"Arguments\" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? Q(e, t) : void 0;\n  }\n}\nfunction Q(e, t) {\n  (null == t || t > e.length) && (t = e.length);\n  for (var r = 0, n = new Array(t); r < t; r++) n[r] = e[r];\n  return n;\n}\nvar X = {\n    ACCEPT: \"Accept\",\n    ADD: \"Add\",\n    ANNOUNCE: \"Announce\",\n    ARRIVE: \"Arrive\",\n    BLOCK: \"Block\",\n    CREATE: \"Create\",\n    DELETE: \"Delete\",\n    DISLIKE: \"Dislike\",\n    FLAG: \"Flag\",\n    FOLLOW: \"Follow\",\n    IGNORE: \"Ignore\",\n    INVITE: \"Invite\",\n    JOIN: \"Join\",\n    LEAVE: \"Leave\",\n    LIKE: \"Like\",\n    LISTEN: \"Listen\",\n    MOVE: \"Move\",\n    OFFER: \"Offer\",\n    QUESTION: \"Question\",\n    REJECT: \"Reject\",\n    READ: \"Read\",\n    REMOVE: \"Remove\",\n    TENTATIVE_REJECT: \"TentativeReject\",\n    TENTATIVE_ACCEPT: \"TentativeAccept\",\n    TRAVAL: \"Travel\",\n    UNDO: \"Undo\",\n    UPDATE: \"Update\",\n    VIEW: \"View\"\n  },\n  Y = {\n    APPLICATION: \"Application\",\n    GROUP: \"Group\",\n    ORGANIZATION: \"Organization\",\n    PERSON: \"Person\",\n    SERVICE: \"Service\"\n  },\n  Z = {\n    ARTICLE: \"Article\",\n    AUDIO: \"Audio\",\n    DOCUMENT: \"Document\",\n    EVENT: \"Event\",\n    IMAGE: \"Image\",\n    NOTE: \"Note\",\n    PAGE: \"Page\",\n    PLACE: \"Place\",\n    PROFILE: \"Profile\",\n    RELATIONSHIP: \"Relationship\",\n    TOMBSTONE: \"Tombstone\",\n    VIDEO: \"Video\"\n  },\n  $ = \"https://www.w3.org/ns/activitystreams#Public\",\n  ee = function ee() {\n    var e = c().identity,\n      n = t(function () {\n        var t;\n        if (null != e && e.webIdData) return null == e || null === (t = e.webIdData) || void 0 === t ? void 0 : t.outbox;\n      }, [e]),\n      o = t(function () {\n        var t, r;\n        if (null != e && e.webIdData) return (null == e || null === (t = e.webIdData) || void 0 === t || null === (r = t.endpoints) || void 0 === r ? void 0 : r[\"void:sparqlEndpoint\"]) || (null == e ? void 0 : e.id) + \"/sparql\";\n      }, [e]);\n    return {\n      post: r(function () {\n        var e = G(B().mark(function e(t) {\n          var r, o, i;\n          return B().wrap(function (e) {\n            for (;;) switch (e.prev = e.next) {\n              case 0:\n                return r = localStorage.getItem(\"token\"), e.next = 3, l.fetchJson(n, {\n                  method: \"POST\",\n                  body: JSON.stringify(U({\n                    \"@context\": \"https://www.w3.org/ns/activitystreams\"\n                  }, t)),\n                  headers: new Headers({\n                    \"Content-Type\": \"application/ld+json\",\n                    Authorization: \"Bearer \".concat(r)\n                  })\n                });\n              case 3:\n                return o = e.sent, i = o.headers, e.abrupt(\"return\", i.get(\"Location\"));\n              case 6:\n              case \"end\":\n                return e.stop();\n            }\n          }, e);\n        }));\n        return function (t) {\n          return e.apply(this, arguments);\n        };\n      }(), [n]),\n      fetch: r(G(B().mark(function e() {\n        var t, r, i, a, c;\n        return B().wrap(function (e) {\n          for (;;) switch (e.prev = e.next) {\n            case 0:\n              if (o && n) {\n                e.next = 2;\n                break;\n              }\n              return e.abrupt(\"return\");\n            case 2:\n              return t = localStorage.getItem(\"token\"), r = k([\"as:object\"]), i = \"\\n      PREFIX as: <https://www.w3.org/ns/activitystreams#>\\n      CONSTRUCT {\\n        ?s1 ?p1 ?o1 .\\n        \".concat(r.construct, \"\\n      }\\n      WHERE {\\n        <\").concat(n, \"> as:items ?s1 .\\n        ?s1 ?p1 ?o1 .\\n        \").concat(r.where, \"\\n      }\\n    \"), e.next = 7, l.fetchJson(o, {\n                method: \"POST\",\n                body: i,\n                headers: new Headers({\n                  Accept: \"application/ld+json\",\n                  Authorization: t ? \"Bearer \".concat(t) : void 0\n                })\n              });\n            case 7:\n              if (a = e.sent, !(c = a.json)[\"@graph\"]) {\n                e.next = 13;\n                break;\n              }\n              return e.abrupt(\"return\", c[\"@graph\"]);\n            case 13:\n              return e.abrupt(\"return\", null);\n            case 14:\n            case \"end\":\n              return e.stop();\n          }\n        }, e);\n      })), [o, n]),\n      url: n,\n      owner: null == e ? void 0 : e.id\n    };\n  },\n  te = R.extend({\n    renderHTML: function renderHTML(e) {\n      var t = e.node,\n        r = e.HTMLAttributes;\n      return [\"span\", C(this.options.HTMLAttributes, r), \"@\".concat(t.attrs.id.label)];\n    },\n    addAttributes: function addAttributes() {\n      return {\n        label: {\n          default: null,\n          parseHTML: function parseHTML(e) {\n            return {\n              label: e.getAttribute(\"data-mention-label\")\n            };\n          },\n          renderHTML: function renderHTML(e) {\n            return e.id.label ? {\n              \"data-mention-label\": e.id.label\n            } : {};\n          }\n        },\n        id: {\n          default: null,\n          parseHTML: function parseHTML(e) {\n            return {\n              id: e.getAttribute(\"data-mention-id\")\n            };\n          },\n          renderHTML: function renderHTML(e) {\n            return e.id.id ? {\n              \"data-mention-id\": e.id.id\n            } : {};\n          }\n        }\n      };\n    }\n  }),\n  re = E(function (e) {\n    return {\n      form: {\n        marginTop: -12\n      },\n      container: {\n        paddingLeft: 80,\n        position: \"relative\"\n      },\n      avatar: {\n        position: \"absolute\",\n        top: 16,\n        left: 0,\n        bottom: 0,\n        width: 64,\n        height: 64\n      },\n      editorContent: {\n        \"& > div\": {\n          backgroundColor: \"rgba(0, 0, 0, 0.09)\",\n          padding: \"2px 12px\",\n          borderWidth: \"0px !important\",\n          borderRadius: 0,\n          borderBottom: \"1px solid #FFF\",\n          minHeight: 60,\n          outline: \"unset !important\"\n        },\n        \"& > div > p\": {\n          marginTop: 12,\n          marginBottom: 12,\n          fontFamily: e.typography.body1.fontFamily,\n          marginBlockStart: \"0.5em\",\n          marginBlockEnd: \"0.5em\"\n        },\n        \"& > div > p.is-editor-empty:first-child::before\": {\n          color: \"grey\",\n          content: \"attr(data-placeholder)\",\n          float: \"left\",\n          height: 0,\n          pointerEvents: \"none\"\n        },\n        marginBottom: -19\n      },\n      button: {\n        marginBottom: 15\n      }\n    };\n  }),\n  ne = function ne(t) {\n    var o = t.context,\n      i = t.placeholder,\n      a = t.helperText,\n      l = t.mentions,\n      d = t.userResource,\n      f = t.addItem,\n      p = t.removeItem,\n      m = u(),\n      h = c().identity,\n      v = j(d),\n      E = re(),\n      I = s(),\n      L = ee(),\n      k = W(n(!1), 2),\n      C = k[0],\n      R = k[1],\n      S = W(n(!1), 2),\n      P = S[0],\n      D = S[1],\n      F = r(function () {\n        var e = G(B().mark(function e(t, r) {\n          var n, i, a, c, l, u;\n          return B().wrap(function (e) {\n            for (;;) switch (e.prev = e.next) {\n              case 0:\n                if (n = r.reset, i = new DOMParser().parseFromString(t.comment, \"text/html\"), a = Array.from(i.body.getElementsByClassName(\"mention\")), c = [], a.forEach(function (e) {\n                  var t = e.attributes[\"data-mention-id\"].value,\n                    r = e.attributes[\"data-mention-label\"].value,\n                    n = i.createElement(\"a\");\n                  n.setAttribute(\"href\", new URL(window.location.href).origin + \"/\" + d + \"/\" + encodeURIComponent(t) + \"/show\"), n.textContent = \"@\" + r, e.parentNode.replaceChild(n, e), c.push(t);\n                }), \"undefined\" !== i.body.innerHTML) {\n                  e.next = 9;\n                  break;\n                }\n                I(\"Votre commentaire est vide\", \"error\"), e.next = 24;\n                break;\n              case 9:\n                return l = Date.now(), u = {\n                  type: Z.NOTE,\n                  attributedTo: L.owner,\n                  content: i.body.innerHTML,\n                  inReplyTo: m[o],\n                  published: new Date().toISOString()\n                }, e.prev = 11, f(U({\n                  id: l\n                }, u)), n(), R(!1), e.next = 17, L.post(U(U({}, u), {}, {\n                  to: [].concat(c, [$])\n                }));\n              case 17:\n                I(\"Commentaire posté avec succès\", \"success\"), e.next = 24;\n                break;\n              case 20:\n                e.prev = 20, e.t0 = e.catch(11), p(l), I(e.t0.message, \"error\");\n              case 24:\n              case \"end\":\n                return e.stop();\n            }\n          }, e, null, [[11, 20]]);\n        }));\n        return function (t, r) {\n          return e.apply(this, arguments);\n        };\n      }(), [L, I, R, f, p]),\n      M = r(function () {\n        h.id || D(!0);\n      }, [h, D]);\n    return l && !l.items || !h ? null : e.createElement(e.Fragment, null, e.createElement(w, {\n      onSubmit: F,\n      subscription: {\n        submitting: !0,\n        pristine: !0\n      },\n      render: function render(t) {\n        var r,\n          n,\n          o,\n          c,\n          u = t.handleSubmit,\n          s = t.submitting;\n        if (t.pristine) {\n          var d = document.getElementById(\"comment\");\n          d && \"\" !== d.textContent && (d.innerHTML = \"\");\n        }\n        return e.createElement(\"form\", {\n          onSubmit: u,\n          className: E.form\n        }, e.createElement(x, {\n          className: E.container,\n          onClick: M\n        }, e.createElement(O, {\n          src: (null == h || null === (r = h.webIdData) || void 0 === r ? void 0 : r[null == v || null === (n = v.fieldsMapping) || void 0 === n ? void 0 : n.image]) || (null == h || null === (o = h.profileData) || void 0 === o ? void 0 : o[null == v || null === (c = v.fieldsMapping) || void 0 === c ? void 0 : c.image]),\n          className: E.avatar\n        }), e.createElement(y, {\n          source: \"comment\",\n          label: \"\",\n          toolbar: null,\n          fullWidth: !0,\n          classes: {\n            editorContent: E.editorContent\n          },\n          editorOptions: U(U({}, b), {}, {\n            onFocus: function onFocus() {\n              R(!0);\n            },\n            extensions: [].concat(K(b.extensions), [i ? g.configure({\n              placeholder: i\n            }) : null, l ? te.configure({\n              HTMLAttributes: {\n                class: \"mention\"\n              },\n              suggestion: l\n            }) : null]),\n            editable: !!h.id\n          }),\n          helperText: a\n        }), C && e.createElement(T, {\n          type: \"submit\",\n          size: \"small\",\n          variant: \"contained\",\n          color: \"primary\",\n          endIcon: e.createElement(A, null),\n          disabled: s,\n          className: E.button\n        }, \"Envoyer\")));\n      }\n    }), e.createElement(N, {\n      open: P,\n      onClose: function onClose() {\n        return D(!1);\n      },\n      message: \"Pour poster un commentaire, vous devez être connecté.\"\n    }));\n  },\n  oe = E(function () {\n    return {\n      container: {\n        paddingLeft: 80,\n        marginTop: 8,\n        minHeight: 80,\n        position: \"relative\"\n      },\n      avatar: {\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        bottom: 0,\n        width: 64,\n        height: 64\n      },\n      text: {\n        paddingTop: 2,\n        paddingBottom: 8\n      },\n      label: {\n        fontWeight: \"bold\"\n      },\n      content: {\n        \"& p\": {\n          marginBlockStart: \"0.5em\",\n          marginBlockEnd: \"0.5em\"\n        }\n      },\n      loading: {\n        zIndex: 1e3,\n        backgroundColor: \"white\",\n        opacity: .5,\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        minHeight: 200,\n        marginTop: 5\n      }\n    };\n  }),\n  ie = function ie(t) {\n    var r = t.comments,\n      n = t.userResource,\n      o = t.loading,\n      i = oe(),\n      a = j(n);\n    return e.createElement(x, {\n      position: \"relative\"\n    }, r && r.sort(function (e, t) {\n      return new Date(t.published) - new Date(e.published);\n    }).map(function (t) {\n      var r, o;\n      return e.createElement(x, {\n        className: i.container\n      }, e.createElement(x, {\n        className: i.avatar\n      }, e.createElement(S, {\n        record: t,\n        reference: n,\n        source: \"attributedTo\",\n        linkType: \"show\"\n      }, e.createElement(P, {\n        image: null == a || null === (r = a.fieldsMapping) || void 0 === r ? void 0 : r.image\n      }))), e.createElement(x, {\n        className: i.text\n      }, e.createElement(I, {\n        variant: \"body2\"\n      }, e.createElement(S, {\n        record: t,\n        reference: n,\n        source: \"attributedTo\",\n        linkType: \"show\"\n      }, e.createElement(d, {\n        variant: \"body2\",\n        source: null == a || null === (o = a.fieldsMapping) || void 0 === o ? void 0 : o.title,\n        className: i.label\n      })), \" • \", e.createElement(f, {\n        record: t,\n        variant: \"body2\",\n        source: \"published\",\n        showTime: !0\n      })), e.createElement(p, {\n        record: t,\n        variant: \"body1\",\n        source: \"content\",\n        className: i.content\n      })));\n    }), o && e.createElement(x, {\n      minHeight: 200\n    }, e.createElement(x, {\n      alignItems: \"center\",\n      className: i.loading\n    }, e.createElement(L, {\n      size: 60,\n      thickness: 6\n    }))));\n  },\n  ae = function ae(e) {\n    var i = c().identity,\n      a = W(n([]), 2),\n      u = a[0],\n      s = a[1],\n      d = W(n(!1), 2),\n      f = d[0],\n      p = d[1],\n      m = W(n(!1), 2),\n      h = m[0],\n      v = m[1],\n      y = W(n(!1), 2),\n      b = y[0],\n      g = y[1],\n      w = t(function () {\n        if (e) {\n          if (e.startsWith(\"http\")) return e;\n          var t;\n          if (null != i && i.webIdData) return null == i || null === (t = i.webIdData) || void 0 === t ? void 0 : t[e];\n        }\n      }, [i, e]),\n      E = r(G(B().mark(function e() {\n        var t, r;\n        return B().wrap(function (e) {\n          for (;;) switch (e.prev = e.next) {\n            case 0:\n              if (w) {\n                e.next = 2;\n                break;\n              }\n              return e.abrupt(\"return\");\n            case 2:\n              p(!0), t = localStorage.getItem(\"token\"), r = new Headers({\n                Accept: \"application/ld+json\",\n                Authorization: t ? \"Bearer \".concat(t) : void 0\n              }), l.fetchJson(w, {\n                headers: r\n              }).then(function (e) {\n                var t = e.json;\n                t && t.items ? s(t.items) : t && t.orderedItems ? s(t.orderedItems) : s([]), g(!1), v(!0), p(!1);\n              }).catch(function () {\n                g(!0), v(!0), p(!1);\n              });\n            case 6:\n            case \"end\":\n              return e.stop();\n          }\n        }, e);\n      })), [s, v, p, g, w]);\n    o(function () {\n      f || h || b || E();\n    }, [E, f, h, b]);\n    var x = r(function (e) {\n        s(function (t) {\n          return [].concat(K(t), [e]);\n        });\n      }, [s]),\n      O = r(function (e) {\n        s(function (t) {\n          return t.filter(function (t) {\n            return \"string\" == typeof t ? t !== e : t.id !== e;\n          });\n        });\n      }, [s]);\n    return {\n      items: u,\n      loading: f,\n      loaded: h,\n      error: b,\n      refetch: E,\n      addItem: x,\n      removeItem: O,\n      url: w\n    };\n  },\n  ce = function ce(t) {\n    t.source;\n    var r = t.context,\n      n = t.helperText,\n      o = t.placeholder,\n      i = t.userResource,\n      a = t.mentions,\n      c = u(),\n      l = ae(c.replies),\n      s = l.items,\n      d = l.loading,\n      f = l.addItem,\n      p = l.removeItem;\n    if (!i) throw new Error(\"No userResource defined for CommentsField\");\n    return e.createElement(e.Fragment, null, e.createElement(ne, {\n      context: r,\n      helperText: n,\n      userResource: i,\n      placeholder: o,\n      mentions: a,\n      addItem: f,\n      removeItem: p\n    }), e.createElement(ie, {\n      comments: s,\n      loading: d,\n      userResource: i\n    }));\n  };\nce.defaultProps = {\n  addLabel: !0,\n  label: \"Commentaires\",\n  placeholder: \"Commencez à taper votre commentaire...\",\n  source: \"id\",\n  context: \"id\"\n};\nvar le = [\"collectionUrl\", \"resource\", \"children\"],\n  ue = function ue(t) {\n    var r = t.collectionUrl,\n      n = t.resource,\n      o = t.children,\n      i = J(t, le);\n    if (1 !== e.Children.count(o)) throw new Error(\"<CollectionList> only accepts a single child\");\n    var a = m(n, r, {\n        enabled: !!r\n      }),\n      c = a.data;\n    return a.loading ? e.createElement(\"div\", {\n      style: {\n        marginTop: 8\n      }\n    }, e.createElement(h, null)) : c ? e.createElement(D, z({\n      reference: n,\n      record: c,\n      source: \"items\"\n    }, i), o) : null;\n  },\n  se = [\"source\", \"record\", \"reference\", \"children\"],\n  de = function de(t) {\n    var r = t.source,\n      n = t.record,\n      o = t.reference,\n      i = t.children,\n      a = J(t, se);\n    if (1 !== e.Children.count(i)) throw new Error(\"<ReferenceCollectionField> only accepts a single child\");\n    return n && n[r] ? e.createElement(ue, z({\n      resource: o,\n      collectionUrl: n[r]\n    }, a), i) : null;\n  };\nde.defaultProps = {\n  addLabel: !0\n};\nvar fe = function fe() {\n    var e = c().identity,\n      n = t(function () {\n        var t;\n        if (null != e && e.webIdData) return null == e || null === (t = e.webIdData) || void 0 === t ? void 0 : t.inbox;\n      }, [e]),\n      o = t(function () {\n        var t, r;\n        if (null != e && e.webIdData) return (null == e || null === (t = e.webIdData) || void 0 === t || null === (r = t.endpoints) || void 0 === r ? void 0 : r[\"void:sparqlEndpoint\"]) || (null == e ? void 0 : e.id) + \"/sparql\";\n      }, [e]);\n    return {\n      fetch: r(function () {\n        var e = G(B().mark(function e(t) {\n          var r, i, a, c, u, s, d;\n          return B().wrap(function (e) {\n            for (;;) switch (e.prev = e.next) {\n              case 0:\n                if (r = t.filters, console.log(\"inboxUrl\", n, o), o && n) {\n                  e.next = 4;\n                  break;\n                }\n                return e.abrupt(\"return\");\n              case 4:\n                return i = localStorage.getItem(\"token\"), a = k([\"as:object\"]), c = \"\", r && Object.keys(r).forEach(function (e) {\n                  if (r[e]) {\n                    var t = r[e].startsWith(\"http\") ? \"<\".concat(r[e], \">\") : r[e];\n                    c += \"?s1 \".concat(e, \" \").concat(t, \" .\");\n                  }\n                }), u = \"\\n        PREFIX as: <https://www.w3.org/ns/activitystreams#>\\n        CONSTRUCT {\\n          ?s1 ?p1 ?o1 .\\n          \".concat(a.construct, \"\\n        }\\n        WHERE {\\n          <\").concat(n, \"> as:items ?s1 .\\n          ?s1 ?p1 ?o1 .\\n          FILTER( (isIRI(?s1)) ) .\\n          \").concat(c, \"\\n          \").concat(a.where, \"\\n        }\\n      \"), e.next = 11, l.fetchJson(o, {\n                  method: \"POST\",\n                  body: u,\n                  headers: new Headers({\n                    Accept: \"application/ld+json\",\n                    Authorization: i ? \"Bearer \".concat(i) : void 0\n                  })\n                });\n              case 11:\n                if (s = e.sent, !(d = s.json)[\"@graph\"]) {\n                  e.next = 17;\n                  break;\n                }\n                return e.abrupt(\"return\", d[\"@graph\"]);\n              case 17:\n                return e.abrupt(\"return\", null);\n              case 18:\n              case \"end\":\n                return e.stop();\n            }\n          }, e);\n        }));\n        return function (t) {\n          return e.apply(this, arguments);\n        };\n      }(), [o, n]),\n      url: n,\n      owner: null == e ? void 0 : e.id\n    };\n  },\n  pe = function pe() {\n    return {\n      fetch: r(function () {\n        var e = G(B().mark(function e(t) {\n          var r, n, o, i, a, c, u, s, d;\n          return B().wrap(function (e) {\n            for (;;) switch (e.prev = e.next) {\n              case 0:\n                if (r = t.split(\"@\"), (n = W(r, 3))[0], o = n[1], !(i = n[2])) {\n                  e.next = 18;\n                  break;\n                }\n                return a = i.includes(\":\") ? \"http\" : \"https\", c = \"\".concat(a, \"://\").concat(i, \"/.well-known/webfinger?resource=acct:\").concat(o, \"@\").concat(i), e.prev = 4, e.next = 7, l.fetchJson(c);\n              case 7:\n                return u = e.sent, s = u.json, d = s.links.find(function (e) {\n                  return \"application/activity+json\" === e.type;\n                }), e.abrupt(\"return\", d ? d.href : null);\n              case 13:\n                return e.prev = 13, e.t0 = e.catch(4), e.abrupt(\"return\", null);\n              case 16:\n                e.next = 19;\n                break;\n              case 18:\n                return e.abrupt(\"return\", null);\n              case 19:\n              case \"end\":\n                return e.stop();\n            }\n          }, e, null, [[4, 13]]);\n        }));\n        return function (t) {\n          return e.apply(this, arguments);\n        };\n      }(), [])\n    };\n  },\n  me = E(function (e) {\n    return {\n      items: {\n        background: \"#fff\",\n        borderRadius: \"0.5rem\",\n        boxShadow: \"0 0 0 1px rgba(0, 0, 0, 0.05), 0px 10px 20px rgba(0, 0, 0, 0.1)\",\n        color: \"rgba(0, 0, 0, 0.8)\",\n        fontSize: \"0.9rem\",\n        overflow: \"hidden\",\n        padding: \"0.2rem\",\n        position: \"relative\"\n      },\n      item: {\n        background: \"transparent\",\n        border: \"1px solid transparent\",\n        borderRadius: \"0.4rem\",\n        display: \"block\",\n        margin: 0,\n        padding: \"0.2rem 0.4rem\",\n        textAlign: \"left\",\n        width: \"100%\",\n        \"&.selected\": {\n          borderColor: \"#000\"\n        }\n      }\n    };\n  }),\n  he = i(function (t, r) {\n    var i = W(n(0), 2),\n      c = i[0],\n      l = i[1],\n      u = me(),\n      s = function s(e) {\n        var r = t.items[e];\n        r && t.command({\n          id: r\n        });\n      };\n    return o(function () {\n      return l(0);\n    }, [t.items]), a(r, function () {\n      return {\n        onKeyDown: function onKeyDown(e) {\n          var r = e.event;\n          return \"ArrowUp\" === r.key ? (l((c + t.items.length - 1) % t.items.length), !0) : \"ArrowDown\" === r.key ? (l((c + 1) % t.items.length), !0) : \"Enter\" === r.key && (s(c), !0);\n        }\n      };\n    }), e.createElement(\"div\", {\n      className: u.items\n    }, t.items.length ? t.items.map(function (t, r) {\n      return e.createElement(\"button\", {\n        className: u.item + (r === c ? \" selected\" : \"\"),\n        key: r,\n        onClick: function onClick() {\n          return s(r);\n        }\n      }, t.label);\n    }) : e.createElement(\"div\", {\n      className: u.item\n    }, \"Aucun résultat\"));\n  }),\n  ve = function ve() {\n    var e, t;\n    return {\n      onStart: function onStart(r) {\n        e = new F(he, {\n          props: r,\n          editor: r.editor\n        }), t = M(\"body\", {\n          getReferenceClientRect: r.clientRect,\n          appendTo: function appendTo() {\n            return document.body;\n          },\n          content: e.element,\n          showOnCreate: !0,\n          interactive: !0,\n          trigger: \"manual\",\n          placement: \"bottom-start\"\n        });\n      },\n      onUpdate: function onUpdate(r) {\n        e.updateProps(r), t[0].setProps({\n          getReferenceClientRect: r.clientRect\n        });\n      },\n      onKeyDown: function onKeyDown(r) {\n        var n;\n        return \"Escape\" === r.event.key ? (t[0].hide(), !0) : null === (n = e.ref) || void 0 === n ? void 0 : n.onKeyDown(r);\n      },\n      onExit: function onExit() {\n        t[0].destroy(), e.destroy();\n      }\n    };\n  },\n  ye = function ye(e) {\n    var r,\n      n,\n      o = j(e),\n      i = v({\n        type: \"getList\",\n        resource: e,\n        payload: {\n          filter: {\n            _predicates: [null == o || null === (r = o.fieldsMapping) || void 0 === r ? void 0 : r.title],\n            blankNodes: []\n          }\n        }\n      }, {\n        enabled: !(null == o || null === (n = o.fieldsMapping) || void 0 === n || !n.title)\n      }).data,\n      a = t(function () {\n        if (i) return i.map(function (e) {\n          var t;\n          return {\n            id: e.id,\n            label: e[null == o || null === (t = o.fieldsMapping) || void 0 === t ? void 0 : t.title]\n          };\n        });\n      }, [i]);\n    return {\n      items: t(function () {\n        if (a) return function (e) {\n          var t = e.query;\n          return a.filter(function (e) {\n            return e.label.toLowerCase().startsWith(t.toLowerCase());\n          }).slice(0, 5);\n        };\n      }, [a]),\n      render: ve\n    };\n  };\nexport { X as ACTIVITY_TYPES, Y as ACTOR_TYPES, ue as CollectionList, ce as CommentsField, Z as OBJECT_TYPES, $ as PUBLIC_URI, de as ReferenceCollectionField, ae as useCollection, fe as useInbox, ye as useMentions, ee as useOutbox, pe as useWebfinger };","map":{"version":3,"sources":["../src/constants.js","../src/hooks/useOutbox.js","../src/components/CommentsField/CustomMention.js","../src/components/CommentsField/PostCommentForm.js","../src/components/CommentsField/CommentsList.js","../src/hooks/useCollection.js","../src/components/CommentsField/CommentsField.js","../src/components/CollectionList.js","../src/components/ReferenceCollectionField.js","../src/hooks/useInbox.js","../src/hooks/useWebfinger.js","../src/hooks/useMentions/MentionsList.js","../src/hooks/useMentions/renderMentions.js","../src/hooks/useMentions/useMentions.js"],"names":["ACTIVITY_TYPES","ACCEPT","ADD","ANNOUNCE","ARRIVE","BLOCK","CREATE","DELETE","DISLIKE","FLAG","FOLLOW","IGNORE","INVITE","JOIN","LEAVE","LIKE","LISTEN","MOVE","OFFER","QUESTION","REJECT","READ","REMOVE","TENTATIVE_REJECT","TENTATIVE_ACCEPT","TRAVAL","UNDO","UPDATE","VIEW","ACTOR_TYPES","APPLICATION","GROUP","ORGANIZATION","PERSON","SERVICE","OBJECT_TYPES","ARTICLE","AUDIO","DOCUMENT","EVENT","IMAGE","NOTE","PAGE","PLACE","PROFILE","RELATIONSHIP","TOMBSTONE","VIDEO","PUBLIC_URI","useOutbox","identity","useGetIdentity","outboxUrl","useMemo","webIdData","outbox","sparqlEndpoint","endpoints","id","useCallback","activity","token","localStorage","getItem","headers","fetchUtils","fetchJson","method","body","JSON","stringify","@context","Headers","Content-Type","Authorization","get","_asyncToGenerator","blankNodesQuery","buildBlankNodesQuery","query","construct","where","json","Accept","undefined","post","fetch","url","owner","CustomMention","Mention","extend","renderHTML","node","HTMLAttributes","mergeAttributes","this","options","attrs","label","addAttributes","default","parseHTML","element","getAttribute","attributes","data-mention-label","data-mention-id","useStyles","makeStyles","form","marginTop","container","paddingLeft","position","avatar","top","left","bottom","width","height","editorContent","& > div","backgroundColor","padding","borderWidth","borderRadius","borderBottom","minHeight","outline","& > div > p","marginBottom","fontFamily","theme","typography","body1","marginBlockStart","marginBlockEnd","& > div > p.is-editor-empty:first-child::before","color","content","float","pointerEvents","button","PostCommentForm","context","placeholder","helperText","mentions","userResource","addItem","removeItem","_ref","record","useRecordContext","userDataModel","useDataModel","classes","notify","useNotify","_useState2","expanded","setExpanded","useState","_useState4","openAuth","setOpenAuth","onSubmit","values","reset","document","DOMParser","parseFromString","comment","Array","from","getElementsByClassName","mentionedUsersUris","forEach","userUri","value","userLabel","link","createElement","setAttribute","URL","window","location","href","origin","encodeURIComponent","textContent","parentNode","replaceChild","push","innerHTML","tempId","Date","now","note","type","attributedTo","inReplyTo","published","toISOString","_objectSpread","to","_context","message","openAuthIfDisconnected","items","React","Form","subscription","submitting","pristine","render","handleSubmit","_ref4","commentElement","getElementById","className","Box","onClick","Avatar","src","fieldsMapping","image","profileData","RichTextInput","source","toolbar","fullWidth","editorOptions","DefaultEditorOptions","onFocus","extensions","Placeholder","configure","class","suggestion","editable","Button","size","variant","endIcon","disabled","AuthDialog","open","onClose","text","paddingTop","paddingBottom","fontWeight","& p","loading","zIndex","opacity","right","display","alignItems","justifyContent","CommentsList","comments","sort","a","b","map","ReferenceField","reference","linkType","AvatarWithLabelField","Typography","TextField","_userDataModel$fields2","title","DateField","showTime","RichTextField","CircularProgress","thickness","useCollection","setItems","setLoading","_useState6","loaded","setLoaded","_useState8","error","setError","collectionUrl","predicateOrUrl","startsWith","then","_ref2","orderedItems","useEffect","oldItems","item","filter","itemId","refetch","CommentsField","_useCollection","replies","Error","defaultProps","addLabel","CollectionList","resource","children","rest","Children","count","data","collection","useGetOne","enabled","style","LinearProgress","ReferenceArrayField","ReferenceCollectionField","useInbox","inboxUrl","inbox","filters","console","log","filtersWhereQuery","Object","keys","predicate","object","useWebfinger","username","host","split","protocol","includes","webfingerUrl","links","find","l","background","boxShadow","fontSize","overflow","border","margin","textAlign","&.selected","borderColor","MentionsList","forwardRef","props","ref","selectedIndex","setSelectedIndex","selectItem","index","command","length","useImperativeHandle","onKeyDown","event","key","renderMentions","component","popup","onStart","ReactRenderer","editor","tippy","getReferenceClientRect","clientRect","appendTo","showOnCreate","interactive","trigger","placement","onUpdate","updateProps","setProps","hide","onExit","destroy","useMentions","useQuery","payload","_predicates","blankNodes","availableMentions","toLowerCase","slice"],"mappings":"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","sourcesContent":["export const ACTIVITY_TYPES = {\n  ACCEPT: 'Accept',\n  ADD: 'Add',\n  ANNOUNCE: 'Announce',\n  ARRIVE: 'Arrive',\n  BLOCK: 'Block',\n  CREATE: 'Create',\n  DELETE: 'Delete',\n  DISLIKE: 'Dislike',\n  FLAG: 'Flag',\n  FOLLOW: 'Follow',\n  IGNORE: 'Ignore',\n  INVITE: 'Invite',\n  JOIN: 'Join',\n  LEAVE: 'Leave',\n  LIKE: 'Like',\n  LISTEN: 'Listen',\n  MOVE: 'Move',\n  OFFER: 'Offer',\n  QUESTION: 'Question',\n  REJECT: 'Reject',\n  READ: 'Read',\n  REMOVE: 'Remove',\n  TENTATIVE_REJECT: 'TentativeReject',\n  TENTATIVE_ACCEPT: 'TentativeAccept',\n  TRAVAL: 'Travel',\n  UNDO: 'Undo',\n  UPDATE: 'Update',\n  VIEW: 'View'\n};\n\nexport const ACTOR_TYPES = {\n  APPLICATION: 'Application',\n  GROUP: 'Group',\n  ORGANIZATION: 'Organization',\n  PERSON: 'Person',\n  SERVICE: 'Service'\n};\n\nexport const OBJECT_TYPES = {\n  ARTICLE: 'Article',\n  AUDIO: 'Audio',\n  DOCUMENT: 'Document',\n  EVENT: 'Event',\n  IMAGE: 'Image',\n  NOTE: 'Note',\n  PAGE: 'Page',\n  PLACE: 'Place',\n  PROFILE: 'Profile',\n  RELATIONSHIP: 'Relationship',\n  TOMBSTONE: 'Tombstone',\n  VIDEO: 'Video'\n};\n\nexport const PUBLIC_URI = 'https://www.w3.org/ns/activitystreams#Public';\n","import { useCallback, useMemo } from 'react';\nimport { useGetIdentity, fetchUtils } from 'react-admin';\nimport { buildBlankNodesQuery } from '@semapps/semantic-data-provider';\n\nconst useOutbox = () => {\n  const { identity } = useGetIdentity();\n\n  const outboxUrl = useMemo(() => {\n    if (identity?.webIdData) {\n      return identity?.webIdData?.outbox;\n    }\n  }, [identity]);\n\n  const sparqlEndpoint = useMemo(() => {\n    if (identity?.webIdData) {\n      return identity?.webIdData?.endpoints?.['void:sparqlEndpoint'] || (identity?.id + '/sparql');\n    }\n  }, [identity]);\n\n  // Post an activity to the logged user's outbox and return its URI\n  const post = useCallback(\n    async activity => {\n      const token = localStorage.getItem('token');\n      const { headers } = await fetchUtils.fetchJson(outboxUrl, {\n        method: 'POST',\n        body: JSON.stringify({\n          '@context': 'https://www.w3.org/ns/activitystreams',\n          ...activity\n        }),\n        headers: new Headers({\n          'Content-Type': 'application/ld+json',\n          Authorization: `Bearer ${token}`\n        })\n      });\n      return headers.get('Location');\n    },\n    [outboxUrl]\n  );\n\n  const fetch = useCallback(async () => {\n    if (!sparqlEndpoint || !outboxUrl) return;\n\n    const token = localStorage.getItem('token');\n    const blankNodesQuery = buildBlankNodesQuery(['as:object']);\n\n    const query = `\n      PREFIX as: <https://www.w3.org/ns/activitystreams#>\n      CONSTRUCT {\n        ?s1 ?p1 ?o1 .\n        ${blankNodesQuery.construct}\n      }\n      WHERE {\n        <${outboxUrl}> as:items ?s1 .\n        ?s1 ?p1 ?o1 .\n        ${blankNodesQuery.where}\n      }\n    `;\n\n    const { json } = await fetchUtils.fetchJson(sparqlEndpoint, {\n      method: 'POST',\n      body: query,\n      headers: new Headers({\n        Accept: 'application/ld+json',\n        Authorization: token ? `Bearer ${token}` : undefined\n      })\n    });\n\n    if (json['@graph']) {\n      return json['@graph'];\n    } else {\n      return null;\n    }\n  }, [sparqlEndpoint, outboxUrl]);\n\n  return { post, fetch, url: outboxUrl, owner: identity?.id };\n};\n\nexport default useOutbox;\n","import { mergeAttributes } from '@tiptap/core';\nimport Mention from '@tiptap/extension-mention';\n\n// Fix a bug in the current version of the mention extension\n// (The { id, label } object is located inside the id property)\n// See https://github.com/ueberdosis/tiptap/pull/1322\nconst CustomMention = Mention.extend({\n  renderHTML({ node, HTMLAttributes }) {\n    return ['span', mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), `@${node.attrs.id.label}`];\n  },\n  addAttributes() {\n    return {\n      label: {\n        default: null,\n        parseHTML: element => {\n          return {\n            label: element.getAttribute('data-mention-label')\n          };\n        },\n        renderHTML: attributes => {\n          if (!attributes.id.label) {\n            return {};\n          }\n          return {\n            'data-mention-label': attributes.id.label\n          };\n        }\n      },\n      id: {\n        default: null,\n        parseHTML: element => {\n          return {\n            id: element.getAttribute('data-mention-id')\n          };\n        },\n        renderHTML: attributes => {\n          if (!attributes.id.id) {\n            return {};\n          }\n          return {\n            'data-mention-id': attributes.id.id\n          };\n        }\n      }\n    };\n  }\n});\n\nexport default CustomMention;\n","import React, { useState, useCallback } from 'react';\nimport { useGetIdentity, useNotify, useRecordContext } from 'react-admin';\nimport { RichTextInput, DefaultEditorOptions } from 'ra-richtext-tiptap';\nimport Placeholder from '@tiptap/extension-placeholder';\nimport { Form } from 'react-final-form';\nimport { Button, Box, makeStyles, Avatar } from '@material-ui/core';\nimport SendIcon from '@material-ui/icons/Send';\nimport { useDataModel } from '@semapps/semantic-data-provider';\nimport { AuthDialog } from '@semapps/auth-provider';\nimport { OBJECT_TYPES, PUBLIC_URI } from '../../constants';\nimport useOutbox from '../../hooks/useOutbox';\nimport CustomMention from './CustomMention';\n\nconst useStyles = makeStyles(theme => ({\n  form: {\n    marginTop: -12 // Negative margin to keep the form close to the label\n  },\n  container: {\n    paddingLeft: 80,\n    position: 'relative'\n  },\n  avatar: {\n    position: 'absolute',\n    top: 16,\n    left: 0,\n    bottom: 0,\n    width: 64,\n    height: 64\n  },\n  editorContent: {\n    '& > div': {\n      backgroundColor: 'rgba(0, 0, 0, 0.09)',\n      padding: '2px 12px',\n      borderWidth: '0px !important',\n      borderRadius: 0,\n      borderBottom: '1px solid #FFF',\n      minHeight: 60,\n      outline: 'unset !important'\n    },\n    '& > div > p': {\n      marginTop: 12,\n      marginBottom: 12,\n      fontFamily: theme.typography.body1.fontFamily,\n      marginBlockStart: '0.5em',\n      marginBlockEnd: '0.5em'\n    },\n    '& > div > p.is-editor-empty:first-child::before': {\n      color: 'grey',\n      content: 'attr(data-placeholder)',\n      float: 'left',\n      height: 0,\n      pointerEvents: 'none'\n    },\n    marginBottom: -19 // To hide helper text block\n  },\n  button: {\n    marginBottom: 15\n  }\n}));\n\nconst PostCommentForm = ({ context, placeholder, helperText, mentions, userResource, addItem, removeItem }) => {\n  const record = useRecordContext();\n  const { identity } = useGetIdentity();\n  const userDataModel = useDataModel(userResource);\n  const classes = useStyles();\n  const notify = useNotify();\n  const outbox = useOutbox();\n  const [expanded, setExpanded] = useState(false);\n  const [openAuth, setOpenAuth] = useState(false);\n\n  const onSubmit = useCallback(\n    async (values, { reset }) => {\n      const document = new DOMParser().parseFromString(values.comment, 'text/html');\n      const mentions = Array.from(document.body.getElementsByClassName('mention'));\n      let mentionedUsersUris = [];\n\n      mentions.forEach(node => {\n        const userUri = node.attributes['data-mention-id'].value;\n        const userLabel = node.attributes['data-mention-label'].value;\n        const link = document.createElement('a');\n        link.setAttribute(\n          'href',\n          new URL(window.location.href).origin + '/' + userResource + '/' + encodeURIComponent(userUri) + '/show'\n        );\n        link.textContent = '@' + userLabel;\n        node.parentNode.replaceChild(link, node);\n        mentionedUsersUris.push(userUri);\n      });\n\n      if (document.body.innerHTML === 'undefined') {\n        notify('Votre commentaire est vide', 'error');\n      } else {\n        const tempId = Date.now();\n\n        const note = {\n          type: OBJECT_TYPES.NOTE,\n          attributedTo: outbox.owner,\n          content: document.body.innerHTML,\n          inReplyTo: record[context],\n          published: new Date().toISOString()\n        };\n\n        try {\n          addItem({ id: tempId, ...note });\n          reset();\n          setExpanded(false);\n          await outbox.post({ ...note, to: [...mentionedUsersUris, PUBLIC_URI] });\n          notify('Commentaire posté avec succès', 'success');\n        } catch (e) {\n          removeItem(tempId);\n          notify(e.message, 'error');\n        }\n      }\n    },\n    [outbox, notify, setExpanded, addItem, removeItem]\n  );\n\n  const openAuthIfDisconnected = useCallback(() => {\n    if (!identity.id) {\n      setOpenAuth(true);\n    }\n  }, [identity, setOpenAuth]);\n\n  // Don't init the editor options until mentions and identity are loaded, as they can only be initialized once\n  if ((mentions && !mentions.items) || !identity) return null;\n\n  return (\n    <>\n      <Form\n        onSubmit={onSubmit}\n        subscription={{ submitting: true, pristine: true }}\n        render={({ handleSubmit, submitting, pristine }) => {\n          // Hack to clear comment input when form is reset\n          // TODO When we update to React-Admin 4, check if the new RichTextInput solves this bug\n          if (pristine) {\n            const commentElement = document.getElementById('comment');\n            if (commentElement && commentElement.textContent !== '') commentElement.innerHTML = '';\n          }\n          return (\n            <form onSubmit={handleSubmit} className={classes.form}>\n              <Box className={classes.container} onClick={openAuthIfDisconnected}>\n                <Avatar src={identity?.webIdData?.[userDataModel?.fieldsMapping?.image] || identity?.profileData?.[userDataModel?.fieldsMapping?.image]} className={classes.avatar} />\n                <RichTextInput\n                  source=\"comment\"\n                  label=\"\"\n                  toolbar={null}\n                  fullWidth\n                  classes={{ editorContent: classes.editorContent }}\n                  editorOptions={{\n                    ...DefaultEditorOptions,\n                    onFocus() {\n                      setExpanded(true);\n                    },\n                    extensions: [\n                      ...DefaultEditorOptions.extensions,\n                      placeholder\n                        ? Placeholder.configure({ placeholder })\n                        : null,\n                      mentions\n                        ? CustomMention.configure({\n                            HTMLAttributes: {\n                              class: 'mention'\n                            },\n                            suggestion: mentions\n                          })\n                        : null\n                    ],\n                    // Disable editor if user is not connected\n                    editable: !!identity.id\n                  }}\n                  helperText={helperText}\n                />\n                {expanded && (\n                  <Button\n                    type=\"submit\"\n                    size=\"small\"\n                    variant=\"contained\"\n                    color=\"primary\"\n                    endIcon={<SendIcon />}\n                    disabled={submitting}\n                    className={classes.button}\n                  >\n                    Envoyer\n                  </Button>\n                )}\n              </Box>\n            </form>\n          );\n        }}\n      />\n      <AuthDialog\n        open={openAuth}\n        onClose={() => setOpenAuth(false)}\n        message=\"Pour poster un commentaire, vous devez être connecté.\"\n      />\n    </>\n  );\n};\n\nexport default PostCommentForm;\n","import React from 'react';\nimport { TextField, RichTextField, DateField } from 'react-admin';\nimport { Box, Typography, CircularProgress, makeStyles } from '@material-ui/core';\nimport { useDataModel } from '@semapps/semantic-data-provider';\nimport { AvatarWithLabelField, ReferenceField } from '@semapps/field-components';\n\nconst useStyles = makeStyles(() => ({\n  container: {\n    paddingLeft: 80,\n    marginTop: 8,\n    minHeight: 80,\n    position: 'relative'\n  },\n  avatar: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    bottom: 0,\n    width: 64,\n    height: 64\n  },\n  text: {\n    paddingTop: 2,\n    paddingBottom: 8\n  },\n  label: {\n    fontWeight: 'bold'\n  },\n  content: {\n    '& p': {\n      marginBlockStart: '0.5em',\n      marginBlockEnd: '0.5em'\n    }\n  },\n  loading: {\n    zIndex: 1000,\n    backgroundColor: 'white',\n    opacity: 0.5,\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: 200,\n    marginTop: 5\n  }\n}));\n\nconst CommentsList = ({ comments, userResource, loading }) => {\n  const classes = useStyles();\n  const userDataModel = useDataModel(userResource);\n  return (\n    <Box position=\"relative\">\n      {comments &&\n        comments\n          .sort((a, b) => new Date(b.published) - new Date(a.published))\n          .map(comment => (\n            <Box className={classes.container}>\n              <Box className={classes.avatar}>\n                <ReferenceField record={comment} reference={userResource} source=\"attributedTo\" linkType=\"show\">\n                  <AvatarWithLabelField image={userDataModel?.fieldsMapping?.image} />\n                </ReferenceField>\n              </Box>\n              <Box className={classes.text}>\n                <Typography variant=\"body2\">\n                  <ReferenceField record={comment} reference={userResource} source=\"attributedTo\" linkType=\"show\">\n                    <TextField variant=\"body2\" source={userDataModel?.fieldsMapping?.title} className={classes.label} />\n                  </ReferenceField>\n                  &nbsp;•&nbsp;\n                  <DateField record={comment} variant=\"body2\" source=\"published\" showTime />\n                </Typography>\n                <RichTextField record={comment} variant=\"body1\" source=\"content\" className={classes.content} />\n              </Box>\n            </Box>\n          ))}\n      {loading && (\n        <Box minHeight={200}>\n          <Box alignItems=\"center\" className={classes.loading}>\n            <CircularProgress size={60} thickness={6} />\n          </Box>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default CommentsList;\n","import { useCallback, useMemo, useState, useEffect } from 'react';\nimport { useGetIdentity, fetchUtils } from 'react-admin';\n\nconst useCollection = predicateOrUrl => {\n  const { identity } = useGetIdentity();\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [loaded, setLoaded] = useState(false);\n  const [error, setError] = useState(false);\n\n  const collectionUrl = useMemo(() => {\n    if (predicateOrUrl) {\n      if (predicateOrUrl.startsWith('http')) {\n        return predicateOrUrl;\n      } else if (identity?.webIdData) {\n        return identity?.webIdData?.[predicateOrUrl];\n      }\n    }\n  }, [identity, predicateOrUrl]);\n\n  const fetch = useCallback(async () => {\n    if (!collectionUrl) return;\n\n    setLoading(true);\n    const token = localStorage.getItem('token');\n    const headers = new Headers({\n      Accept: 'application/ld+json',\n      Authorization: token ? `Bearer ${token}` : undefined\n    });\n\n    fetchUtils\n      .fetchJson(collectionUrl, { headers })\n      .then(({ json }) => {\n        if (json && json.items) {\n          setItems(json.items);\n        } else if (json && json.orderedItems) {\n          setItems(json.orderedItems);\n        } else {\n          setItems([]);\n        }\n        setError(false);\n        setLoaded(true);\n        setLoading(false);\n      })\n      .catch(() => {\n        setError(true);\n        setLoaded(true);\n        setLoading(false);\n      });\n  }, [setItems, setLoaded, setLoading, setError, collectionUrl]);\n\n  useEffect(() => {\n    if (!loading && !loaded && !error) {\n      fetch();\n    }\n  }, [fetch, loading, loaded, error]);\n\n  const addItem = useCallback(\n    item => {\n      setItems(oldItems => [...oldItems, item]);\n    },\n    [setItems]\n  );\n\n  const removeItem = useCallback(\n    itemId => {\n      setItems(oldItems => oldItems.filter(item => (typeof item === 'string' ? item !== itemId : item.id !== itemId)));\n    },\n    [setItems]\n  );\n\n  return { items, loading, loaded, error, refetch: fetch, addItem, removeItem, url: collectionUrl };\n};\n\nexport default useCollection;\n","import React from 'react';\nimport { useRecordContext } from 'react-admin';\nimport PostCommentForm from './PostCommentForm';\nimport CommentsList from './CommentsList';\nimport useCollection from '../../hooks/useCollection';\n\nconst CommentsField = ({ source, context, helperText, placeholder, userResource, mentions }) => {\n  const record = useRecordContext();\n  const { items: comments, loading, addItem, removeItem } = useCollection(record.replies);\n  if (!userResource) throw new Error('No userResource defined for CommentsField');\n  return (\n    <>\n      <PostCommentForm\n        context={context}\n        helperText={helperText}\n        userResource={userResource}\n        placeholder={placeholder}\n        mentions={mentions}\n        addItem={addItem}\n        removeItem={removeItem}\n      />\n      <CommentsList comments={comments} loading={loading} userResource={userResource} />\n    </>\n  );\n};\n\nCommentsField.defaultProps = {\n  addLabel: true,\n  label: 'Commentaires',\n  placeholder: 'Commencez à taper votre commentaire...',\n  source: 'id', // Ensure the field is always displayed\n  context: 'id'\n};\n\nexport default CommentsField;\n","import React from 'react';\nimport { useGetOne, LinearProgress } from 'react-admin';\nimport { ReferenceArrayField } from '@semapps/field-components';\n\nconst CollectionList = ({ collectionUrl, resource, children, ...rest }) => {\n  if (React.Children.count(children) !== 1) {\n    throw new Error('<CollectionList> only accepts a single child');\n  }\n\n  // TODO use a simple fetch call, as the resource is not good and it is useless\n  const { data: collection, loading } = useGetOne(resource, collectionUrl, { enabled: !!collectionUrl });\n\n  if (loading) {\n    return (\n      <div style={{ marginTop: 8 }}>\n        <LinearProgress />\n      </div>\n    );\n  } else if (!collection) {\n    return null;\n  }\n\n  return (\n    <ReferenceArrayField reference={resource} record={collection} source=\"items\" {...rest}>\n      {children}\n    </ReferenceArrayField>\n  );\n};\n\nexport default CollectionList;\n","import React from 'react';\nimport CollectionList from './CollectionList';\n\nconst ReferenceCollectionField = ({ source, record, reference, children, ...rest }) => {\n  if (React.Children.count(children) !== 1) {\n    throw new Error('<ReferenceCollectionField> only accepts a single child');\n  }\n\n  if (!record || !record[source]) return null;\n\n  return (\n    <CollectionList resource={reference} collectionUrl={record[source]} {...rest}>\n      {children}\n    </CollectionList>\n  );\n};\n\nReferenceCollectionField.defaultProps = {\n  addLabel: true\n};\n\nexport default ReferenceCollectionField;\n","import { useCallback, useMemo } from 'react';\nimport { useGetIdentity, fetchUtils } from 'react-admin';\nimport { buildBlankNodesQuery } from '@semapps/semantic-data-provider';\n\nconst useInbox = () => {\n  const { identity } = useGetIdentity();\n\n  const inboxUrl = useMemo(() => {\n    if (identity?.webIdData) {\n      return identity?.webIdData?.inbox;\n    }\n  }, [identity]);\n\n  const sparqlEndpoint = useMemo(() => {\n    if (identity?.webIdData) {\n      return identity?.webIdData?.endpoints?.['void:sparqlEndpoint'] || (identity?.id + '/sparql');\n    }\n  }, [identity]);\n\n  const fetch = useCallback(\n    async ({ filters }) => {\n      console.log('inboxUrl', inboxUrl, sparqlEndpoint);\n\n      if (!sparqlEndpoint || !inboxUrl) return;\n\n      const token = localStorage.getItem('token');\n      const blankNodesQuery = buildBlankNodesQuery(['as:object']);\n\n      let filtersWhereQuery = '';\n      if (filters) {\n        Object.keys(filters).forEach(predicate => {\n          if (filters[predicate]) {\n            const object = filters[predicate].startsWith('http') ? `<${filters[predicate]}>` : filters[predicate];\n            filtersWhereQuery += `?s1 ${predicate} ${object} .`;\n          }\n        });\n      }\n\n      const query = `\n        PREFIX as: <https://www.w3.org/ns/activitystreams#>\n        CONSTRUCT {\n          ?s1 ?p1 ?o1 .\n          ${blankNodesQuery.construct}\n        }\n        WHERE {\n          <${inboxUrl}> as:items ?s1 .\n          ?s1 ?p1 ?o1 .\n          FILTER( (isIRI(?s1)) ) .\n          ${filtersWhereQuery}\n          ${blankNodesQuery.where}\n        }\n      `;\n\n      const { json } = await fetchUtils.fetchJson(sparqlEndpoint, {\n        method: 'POST',\n        body: query,\n        headers: new Headers({\n          Accept: 'application/ld+json',\n          Authorization: token ? `Bearer ${token}` : undefined\n        })\n      });\n\n      if (json['@graph']) {\n        return json['@graph'];\n      } else {\n        return null;\n      }\n    },\n    [sparqlEndpoint, inboxUrl]\n  );\n\n  return { fetch, url: inboxUrl, owner: identity?.id };\n};\n\nexport default useInbox;\n","import { useCallback } from 'react';\nimport { fetchUtils } from 'react-admin';\n\nconst useWebfinger = () => {\n  // Post an activity to the logged user's outbox and return its URI\n  const fetch = useCallback(async id => {\n    // eslint-disable-next-line\n    const [_, username, host] = id.split('@');\n    if (host) {\n      const protocol = host.includes(':') ? 'http' : 'https'; // If the host has a port, we are most likely on localhost\n      const webfingerUrl = `${protocol}://${host}/.well-known/webfinger?resource=acct:${username}@${host}`;\n\n      try {\n        const { json } = await fetchUtils.fetchJson(webfingerUrl);\n\n        const link = json.links.find(l => l.type === 'application/activity+json');\n\n        return link ? link.href : null;\n      } catch (e) {\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }, []);\n\n  return { fetch };\n};\n\nexport default useWebfinger;\n","import React, { useState, useEffect, forwardRef, useImperativeHandle } from 'react';\nimport { makeStyles } from '@material-ui/core';\n\nconst useStyles = makeStyles(theme => ({\n  items: {\n    background: '#fff',\n    borderRadius: '0.5rem',\n    boxShadow: '0 0 0 1px rgba(0, 0, 0, 0.05), 0px 10px 20px rgba(0, 0, 0, 0.1)',\n    color: 'rgba(0, 0, 0, 0.8)',\n    fontSize: '0.9rem',\n    overflow: 'hidden',\n    padding: '0.2rem',\n    position: 'relative'\n  },\n  item: {\n    background: 'transparent',\n    border: '1px solid transparent',\n    borderRadius: '0.4rem',\n    display: 'block',\n    margin: 0,\n    padding: '0.2rem 0.4rem',\n    textAlign: 'left',\n    width: '100%',\n    '&.selected': {\n      borderColor: '#000'\n    }\n  }\n}));\n\nexport default forwardRef((props, ref) => {\n  const [selectedIndex, setSelectedIndex] = useState(0);\n  const classes = useStyles();\n\n  const selectItem = index => {\n    const item = props.items[index];\n\n    if (item) {\n      props.command({ id: item });\n    }\n  };\n\n  const upHandler = () => {\n    setSelectedIndex((selectedIndex + props.items.length - 1) % props.items.length);\n  };\n\n  const downHandler = () => {\n    setSelectedIndex((selectedIndex + 1) % props.items.length);\n  };\n\n  const enterHandler = () => {\n    selectItem(selectedIndex);\n  };\n\n  useEffect(() => setSelectedIndex(0), [props.items]);\n\n  useImperativeHandle(ref, () => ({\n    onKeyDown: ({ event }) => {\n      if (event.key === 'ArrowUp') {\n        upHandler();\n        return true;\n      }\n\n      if (event.key === 'ArrowDown') {\n        downHandler();\n        return true;\n      }\n\n      if (event.key === 'Enter') {\n        enterHandler();\n        return true;\n      }\n\n      return false;\n    }\n  }));\n\n  return (\n    <div className={classes.items}>\n      {props.items.length ? (\n        props.items.map((item, index) => (\n          <button\n            className={classes.item + (index === selectedIndex ? ' selected' : '')}\n            key={index}\n            onClick={() => selectItem(index)}\n          >\n            {item.label}\n          </button>\n        ))\n      ) : (\n        <div className={classes.item}>Aucun résultat</div>\n      )}\n    </div>\n  );\n});\n","import { ReactRenderer } from '@tiptap/react';\nimport tippy from 'tippy.js';\nimport MentionsList from './MentionsList';\n\nconst renderMentions = () => {\n  let component;\n  let popup;\n\n  return {\n    onStart: props => {\n      component = new ReactRenderer(MentionsList, {\n        props,\n        editor: props.editor\n      });\n\n      popup = tippy('body', {\n        getReferenceClientRect: props.clientRect,\n        appendTo: () => document.body,\n        content: component.element,\n        showOnCreate: true,\n        interactive: true,\n        trigger: 'manual',\n        placement: 'bottom-start'\n      });\n    },\n\n    onUpdate(props) {\n      component.updateProps(props);\n\n      popup[0].setProps({\n        getReferenceClientRect: props.clientRect\n      });\n    },\n\n    onKeyDown(props) {\n      if (props.event.key === 'Escape') {\n        popup[0].hide();\n\n        return true;\n      }\n\n      return component.ref?.onKeyDown(props);\n    },\n\n    onExit() {\n      popup[0].destroy();\n      component.destroy();\n    }\n  };\n};\n\nexport default renderMentions;\n","import { useMemo } from 'react';\nimport { useQuery } from 'react-admin';\nimport renderMentions from './renderMentions';\nimport { useDataModel } from '@semapps/semantic-data-provider';\n\nconst useMentions = userResource => {\n  const userDataModel = useDataModel(userResource);\n\n  // The \"enabled\" option doesn't work with useQueryWithStore\n  const { data } = useQuery(\n    {\n      type: 'getList',\n      resource: userResource,\n      payload: {\n        filter: {\n          _predicates: [userDataModel?.fieldsMapping?.title],\n          blankNodes: []\n        }\n      }\n    },\n    {\n      enabled: !!userDataModel?.fieldsMapping?.title\n    }\n  );\n\n  const availableMentions = useMemo(() => {\n    if (data) {\n      return data.map(item => ({ id: item.id, label: item[userDataModel?.fieldsMapping?.title] }));\n    }\n  }, [data]);\n\n  const items = useMemo(() => {\n    if (availableMentions) {\n      return ({ query }) => {\n        return availableMentions.filter(({ label }) => label.toLowerCase().startsWith(query.toLowerCase())).slice(0, 5);\n      };\n    }\n  }, [availableMentions]);\n\n  return {\n    items,\n    render: renderMentions\n  };\n};\n\nexport default useMentions;\n"]},"metadata":{},"sourceType":"module"}